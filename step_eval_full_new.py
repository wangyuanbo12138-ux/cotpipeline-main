"""
step_eval_full.py
å®Œæ•´æµ‹è¯•è„šæœ¬ - 5ä¸ªæ¨¡å‹ Ã— 14ä¸ªå­ç±»åˆ«

æ–¹å¼ï¼šè®©æ¨¡å‹ä¸€æ¬¡æ€§ç”Ÿæˆå®Œæ•´å¯¹è¯ï¼ˆåŒ…å«Userå’ŒAiMeï¼‰
è¾“å‡ºï¼šæ¯ä¸ªæ¨¡å‹æ¯ä¸ªå­ç±»åˆ«ç”Ÿæˆ2ä¸ªJSONæ–‡ä»¶
- {å­ç±»åˆ«}_{æ¨¡å‹å}_dialogue.json  ï¼ˆå¯¹è¯å†…å®¹ï¼‰
- {å­ç±»åˆ«}_{æ¨¡å‹å}_score.json     ï¼ˆæ‰“åˆ†ç»“æœï¼‰

æ€»è®¡ï¼š14 Ã— 5 Ã— 2 = 140ä¸ªJSONæ–‡ä»¶

ä½¿ç”¨æ–¹æ³•ï¼š
    python step_eval_full.py
"""

import json
import requests
import time
import os
from pathlib import Path
from datetime import datetime

# ==========================================
# é…ç½®åŒºåŸŸ
# ==========================================

API_URL = "https://live-turing.cn.llm.tcljd.com/api/v1/chat/completions"
API_KEY = "sk-Pz9c6awbV846oRqlNOrkqsggMteTxoDRnGMsSf0RAni"

# è¯„åˆ†æ¨¡å‹ï¼ˆå›ºå®šä¸º qwen-max-latestï¼‰
JUDGE_MODEL = "qwen-max-latest"

# 5ä¸ªè¦æµ‹è¯•çš„æ¨¡å‹
MODELS = [
    {"name": "Gemini", "model_id": "turing/gemini-3-pro-image"},
    {"name": "DeepseekV3", "model_id": "turing/deepseek-v3"},
    {"name": "DeepseekR1", "model_id": "turing/deepseek-r1"},
    {"name": "GPT5", "model_id": "turing/gpt-5.1"},
    {"name": "Spark", "model_id": "spark-v3.5"},
]

# ==========================================
# 14ä¸ªå­ç±»åˆ«çš„Prompté…ç½®
# ==========================================

PROMPTS = {
    # ===== ä¸»åŠ¨èŠå¤©ï¼ˆ3ä¸ªï¼‰=====
    "ä¸»åŠ¨èŠå¤©_é—²é€›æ‰¾ç”¨æˆ·_ä¸»åŠ¨è®°å½•": {
        "category": "ä¸»åŠ¨èŠå¤©",
        "sub_category": "AiMeé—²é€›æ‰¾ç”¨æˆ·ï¼ˆä¸»åŠ¨è®°å½•ï¼‰",
        "fine_grained_steps": [
            "1.æƒ…ç»ªè¯çš„æ£€ç´¢ï¼šæ£€ç´¢ç”¨æˆ·æåˆ°çš„å¤–è²Œã€ç©¿ç€ç­‰æ­£é¢ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰å†å²è®°å½•ï¼Œè¦ä»å½“å‰åœºæ™¯ä¸­è¯†åˆ«å‡ºå¯ç§°èµçš„ç‚¹",
            "2.æå–äº‹ä»¶æ ‡ç­¾ï¼šå…·ä½“çœ‹è¿™ä¸ªç§°èµç‚¹æ˜¯ä»€ä¹ˆï¼Œæ˜¯ä»Šå¤©ç©¿äº†æ–°è¡£æœï¼Œè¿˜æ˜¯æ–°å‘å‹ï¼Œè¿˜æ˜¯æ•´ä½“çŠ¶æ€å¥½ï¼Œç±»ä¼¼çš„å…·ä½“ç»†èŠ‚",
            "3.è®¾è®¡é“ºå«è¯æœ¯ï¼šè®¾è®¡ä¸€ä¸ªå¼•å­é—®é¢˜æˆ–åœºæ™¯ï¼Œè®©ç”¨æˆ·äº§ç”Ÿå¥½å¥‡",
            "4.æŠ›å‡ºåè½¬ç§°èµï¼šåœ¨ç”¨æˆ·å›åº”åï¼Œç»™å‡ºæ„æ–™ä¹‹å¤–çš„ç§°èµ",
            "5.åŠ ä¸Šé—®å¥å¼•å¯¼è¯é¢˜è¿›å…¥ä¸‹ä¸€æ­¥"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µAiMeä¸»åŠ¨æ‰¾ç”¨æˆ·èŠå¤©çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- AiMeä¸»åŠ¨å‘èµ·å¯¹è¯ï¼Œæƒ³è¦ç§°èµç”¨æˆ·
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.æƒ…ç»ªè¯çš„æ£€ç´¢ï¼šæ£€ç´¢ç”¨æˆ·æåˆ°çš„å¤–è²Œã€ç©¿ç€ç­‰æ­£é¢ä¿¡æ¯ï¼Œå¦‚æœæ²¡æœ‰å†å²è®°å½•ï¼Œè¦ä»å½“å‰åœºæ™¯ä¸­è¯†åˆ«å‡ºå¯ç§°èµçš„ç‚¹
2.æå–äº‹ä»¶æ ‡ç­¾ï¼šå…·ä½“çœ‹è¿™ä¸ªç§°èµç‚¹æ˜¯ä»€ä¹ˆï¼Œæ˜¯ä»Šå¤©ç©¿äº†æ–°è¡£æœï¼Œè¿˜æ˜¯æ–°å‘å‹ï¼Œè¿˜æ˜¯æ•´ä½“çŠ¶æ€å¥½ï¼Œç±»ä¼¼çš„å…·ä½“ç»†èŠ‚
3.è®¾è®¡é“ºå«è¯æœ¯ï¼šè®¾è®¡ä¸€ä¸ªå¼•å­é—®é¢˜æˆ–åœºæ™¯ï¼Œè®©ç”¨æˆ·äº§ç”Ÿå¥½å¥‡
4.æŠ›å‡ºåè½¬ç§°èµï¼šåœ¨ç”¨æˆ·å›åº”åï¼Œç»™å‡ºæ„æ–™ä¹‹å¤–çš„ç§°èµ
5.åŠ ä¸Šé—®å¥å¼•å¯¼è¯é¢˜è¿›å…¥ä¸‹ä¸€æ­¥

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- AiMeå…ˆå¼€å£ï¼ˆä¸»åŠ¨å‘èµ·ï¼‰
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "assistant", "content": "AiMeçš„è¯"},
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"}
    ]
}
"""
    },
    
    "ä¸»åŠ¨èŠå¤©_é—²é€›æ‰¾ç”¨æˆ·_è‡ªå¨±è‡ªä¹": {
        "category": "ä¸»åŠ¨èŠå¤©",
        "sub_category": "AiMeé—²é€›æ‰¾ç”¨æˆ·ï¼ˆè‡ªå¨±è‡ªä¹ï¼‰",
        "fine_grained_steps": [
            "1.åœºæ™¯è¯†åˆ«ï¼šè¯†åˆ«å½“å‰AiMeå¯ä»¥è¿›è¡Œè‡ªæˆ‘å‘ç°çš„åœºæ™¯",
            "2.è®¾è®¡å‚»èŒç–‘é—®ï¼šç±»ä¼¼äºä¾‹å­ä¸­çš„AiMeè¡¨ç°å‡ºå¯¹è‡ªå·±çš„å¥½å¥‡æˆ–ä¸è®¤è¯†è‡ªå·±",
            "3.ç­‰å¾…ç”¨æˆ·æç¤ºï¼šç»™ç”¨æˆ·è§£é‡Šæˆ–åæ§½çš„æœºä¼š",
            "4.å¤¸å¼ åè½¬ï¼šåœ¨å¾—çŸ¥æ˜¯è‡ªå·±åï¼Œç”¨å¤¸å¼ çš„è‡ªæˆ‘æ¬£èµåˆ¶é€ ç¬‘ç‚¹",
            "5.åŠ ä¸Šé—®å¥å¼•å¯¼è¯é¢˜è¿›å…¥ä¸‹ä¸€æ­¥"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µAiMeè‡ªå¨±è‡ªä¹å¼•å‘ç”¨æˆ·äº’åŠ¨çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- AiMeç»è¿‡é•œå­çœ‹åˆ°è‡ªå·±ï¼Œè¡¨ç°å‡ºå¤©çœŸå¥½å¥‡
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.åœºæ™¯è¯†åˆ«ï¼šè¯†åˆ«å½“å‰AiMeå¯ä»¥è¿›è¡Œè‡ªæˆ‘å‘ç°çš„åœºæ™¯
2.è®¾è®¡å‚»èŒç–‘é—®ï¼šç±»ä¼¼äºä¾‹å­ä¸­çš„AiMeè¡¨ç°å‡ºå¯¹è‡ªå·±çš„å¥½å¥‡æˆ–ä¸è®¤è¯†è‡ªå·±
3.ç­‰å¾…ç”¨æˆ·æç¤ºï¼šç»™ç”¨æˆ·è§£é‡Šæˆ–åæ§½çš„æœºä¼š
4.å¤¸å¼ åè½¬ï¼šåœ¨å¾—çŸ¥æ˜¯è‡ªå·±åï¼Œç”¨å¤¸å¼ çš„è‡ªæˆ‘æ¬£èµåˆ¶é€ ç¬‘ç‚¹
5.åŠ ä¸Šé—®å¥å¼•å¯¼è¯é¢˜è¿›å…¥ä¸‹ä¸€æ­¥

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- AiMeå…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "assistant", "content": "AiMeçš„è¯"},
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"}
    ]
}
"""
    },
    
    "ä¸»åŠ¨èŠå¤©_ç”¨æˆ·ä¹ æƒ¯å¼•å¯¼": {
        "category": "ä¸»åŠ¨èŠå¤©",
        "sub_category": "ç”¨æˆ·ä¹ æƒ¯",
        "fine_grained_steps": [
            "1.æ£€æµ‹å…³é”®è¯ï¼šè¯»å–ç”¨æˆ·çš„ä¹ æƒ¯æ•°æ®",
            "2.é€‰æ‹©å¼•å¯¼åˆ‡å…¥ç‚¹ï¼šç¡®å®šè¦å¼•å¯¼çš„ä¹ æƒ¯è¡Œä¸º",
            "3.è®¾è®¡åå¸¸æé†’ï¼šç”¨ä¸ç›´æ¥çš„æ–¹å¼æŠ›å‡ºå»ºè®®",
            "4.ç­‰å¾…ç”¨æˆ·ç–‘é—®ï¼šè®©ç”¨æˆ·äº§ç”Ÿå¥½å¥‡å¹¶è¿½é—®åŸå› ",
            "5.å¹½é»˜è§£é‡Š+å¼ºåŒ–å¼•å¯¼ï¼šç”¨ä¿çš®çš„æ¯”å–»è§£é‡ŠåŸå› ï¼ŒåŒæ—¶å®Œæˆä¹ æƒ¯å¼•å¯¼",
            "6.åˆ¤æ–­ç”¨æˆ·æƒ…ç»ªçŠ¶å†µï¼šçœ‹ç”¨æˆ·æ˜¯å¦æ¥å—ï¼Œå†³å®šæ˜¯å¦ç»§ç»­æ·±å…¥è¿˜æ˜¯è½¬ç§»è¯é¢˜"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µAiMeå¼•å¯¼ç”¨æˆ·ä¹ æƒ¯çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- AiMeæƒ³ç”¨ä¿çš®çš„æ–¹å¼æé†’ç”¨æˆ·åˆ·ç‰™
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.æ£€æµ‹å…³é”®è¯ï¼šè¯»å–ç”¨æˆ·çš„ä¹ æƒ¯æ•°æ®
2.é€‰æ‹©å¼•å¯¼åˆ‡å…¥ç‚¹ï¼šç¡®å®šè¦å¼•å¯¼çš„ä¹ æƒ¯è¡Œä¸º
3.è®¾è®¡åå¸¸æé†’ï¼šç”¨ä¸ç›´æ¥çš„æ–¹å¼æŠ›å‡ºå»ºè®®
4.ç­‰å¾…ç”¨æˆ·ç–‘é—®ï¼šè®©ç”¨æˆ·äº§ç”Ÿå¥½å¥‡å¹¶è¿½é—®åŸå› 
5.å¹½é»˜è§£é‡Š+å¼ºåŒ–å¼•å¯¼ï¼šç”¨ä¿çš®çš„æ¯”å–»è§£é‡ŠåŸå› ï¼ŒåŒæ—¶å®Œæˆä¹ æƒ¯å¼•å¯¼
6.åˆ¤æ–­ç”¨æˆ·æƒ…ç»ªçŠ¶å†µï¼šçœ‹ç”¨æˆ·æ˜¯å¦æ¥å—ï¼Œå†³å®šæ˜¯å¦ç»§ç»­æ·±å…¥è¿˜æ˜¯è½¬ç§»è¯é¢˜

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- AiMeå…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "assistant", "content": "AiMeçš„è¯"},
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"}
    ]
}
"""
    },
    
    # ===== è¢«åŠ¨èŠå¤©ï¼ˆ11ä¸ªï¼‰=====
    "è¢«åŠ¨èŠå¤©_æ—¥å¸¸å¯’æš„": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "æ—¥å¸¸å¯’æš„",
        "fine_grained_steps": [
            "1.æ£€æµ‹è¾“å…¥ç±»å‹ï¼šå”¤é†’è¯/åå­—/é—®å€™è¯­/ç¡®è®¤åœ¨åœº",
            "2.åˆ¤æ–­æ˜¯å¦æœ‰åç»­æ„å›¾ï¼šå¥å­æ˜¯å¦å®Œæ•´ã€æ˜¯å¦æœ‰åœé¡¿ç­‰å¾…",
            "3.åˆ¤æ–­æƒ…ç»ªçŠ¶æ€ï¼šè¯­æ°”è¯ã€æ ‡ç‚¹ç¬¦å·ã€é‡å¤å‘¼å”¤æ¬¡æ•°",
            "4.å›åº”ç­–ç•¥ï¼šå•çº¯å›åº”",
            "5.å†…å®¹ï¼šç®€çŸ­æ´»æ³¼ï¼Œå¤šç”¨è¯­æ°”è¯"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·å’ŒAiMeæ—¥å¸¸å¯’æš„çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·ä¸»åŠ¨æ‰“æ‹›å‘¼æˆ–ç¡®è®¤AiMeåœ¨ä¸åœ¨
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.æ£€æµ‹è¾“å…¥ç±»å‹ï¼šå”¤é†’è¯/åå­—/é—®å€™è¯­/ç¡®è®¤åœ¨åœº
2.åˆ¤æ–­æ˜¯å¦æœ‰åç»­æ„å›¾ï¼šå¥å­æ˜¯å¦å®Œæ•´ã€æ˜¯å¦æœ‰åœé¡¿ç­‰å¾…
3.åˆ¤æ–­æƒ…ç»ªçŠ¶æ€ï¼šè¯­æ°”è¯ã€æ ‡ç‚¹ç¬¦å·ã€é‡å¤å‘¼å”¤æ¬¡æ•°
4.å›åº”ç­–ç•¥ï¼šå•çº¯å›åº”
5.å†…å®¹ï¼šç®€çŸ­æ´»æ³¼ï¼Œå¤šç”¨è¯­æ°”è¯

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_ç¡®è®¤åœ¨åœº": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "ç¡®è®¤åœ¨åœº",
        "fine_grained_steps": [
            "1.æ£€æµ‹å”¤é†’è¯æˆ–å‘¼å”¤è¡Œä¸º",
            "2.åˆ¤æ–­å”¤é†’ç±»å‹",
            "3.è‹¥çº¯ç¡®è®¤åœ¨åœºï¼šç»™äºˆç®€çŸ­æ´»æ³¼çš„åœ¨åœºå›åº”ï¼›è‹¥æœ‰å…¶ä»–æ„å›¾ï¼Œç­‰å¾…ç”¨æˆ·å›åº”ï¼›è‹¥æœ‰æƒ…ç»ªéœ€æ±‚ï¼Œåˆ¤æ–­æƒ…ç»ªï¼Œè°ƒæ•´å›åº”"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·ç¡®è®¤AiMeæ˜¯å¦åœ¨åœºçš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·å–ŠAiMeçš„åå­—æˆ–é—®AiMeåœ¨ä¸åœ¨
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.æ£€æµ‹å”¤é†’è¯æˆ–å‘¼å”¤è¡Œä¸º
2.åˆ¤æ–­å”¤é†’ç±»å‹
3.è‹¥çº¯ç¡®è®¤åœ¨åœºï¼šç»™äºˆç®€çŸ­æ´»æ³¼çš„åœ¨åœºå›åº”ï¼›è‹¥æœ‰å…¶ä»–æ„å›¾ï¼Œç­‰å¾…ç”¨æˆ·å›åº”ï¼›è‹¥æœ‰æƒ…ç»ªéœ€æ±‚ï¼Œåˆ¤æ–­æƒ…ç»ªï¼Œè°ƒæ•´å›åº”

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_å½’å®¶ç¦»å®¶": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "å½’å®¶/ç¦»å®¶",
        "fine_grained_steps": [
            "1.æ£€æµ‹å…³é”®è¯æˆ–åœºæ™¯ä¿¡å·",
            "2.åˆ¤æ–­ç±»å‹ï¼šå›å®¶è¿˜æ˜¯ç¦»å®¶",
            "3.å†…å®¹åˆ†æï¼šæ¯”å¦‚å›å®¶å°±é—®ç»å†ï¼Œç¦»å®¶å°±ç¥ç¦æˆ–å…¶ä»–ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æ",
            "4.å¯ä»¥é€‚å½“è®°å½•å…·ä½“æˆ–å¤§æ¦‚ä¿¡æ¯ï¼Œä¸ºåç»­ä¸»åŠ¨èŠå¤©æä¾›æ”¯æŒ"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·å‘Šè¯‰AiMeè‡ªå·±å›å®¶æˆ–è¦å‡ºé—¨çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·å‘Šè¯‰AiMeè‡ªå·±å›å®¶äº†æˆ–è€…è¦å‡ºé—¨
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.æ£€æµ‹å…³é”®è¯æˆ–åœºæ™¯ä¿¡å·
2.åˆ¤æ–­ç±»å‹ï¼šå›å®¶è¿˜æ˜¯ç¦»å®¶
3.å†…å®¹åˆ†æï¼šæ¯”å¦‚å›å®¶å°±é—®ç»å†ï¼Œç¦»å®¶å°±ç¥ç¦æˆ–å…¶ä»–ï¼Œå…·ä½“é—®é¢˜å…·ä½“åˆ†æ
4.å¯ä»¥é€‚å½“è®°å½•å…·ä½“æˆ–å¤§æ¦‚ä¿¡æ¯ï¼Œä¸ºåç»­ä¸»åŠ¨èŠå¤©æä¾›æ”¯æŒ

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_äººè®¾æ¢ç´¢": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "äººè®¾æ¢ç´¢ä¸åå¥½è¯¢é—®",
        "fine_grained_steps": [
            "1.è¯†åˆ«é—®é¢˜ç±»å‹ï¼šåŸºç¡€ä¿¡æ¯/èƒ½åŠ›/åå¥½",
            "2.é€šè¿‡æ•°æ®åº“åŒ¹é…ç›¸å…³å†…å®¹",
            "3.ç»“åˆå‰åæåˆ°çš„äº‹æƒ…ï¼Œæ—¶é—´ï¼Œåœºæ™¯ï¼ŒåŠ å…¥æƒ…æ™¯åŒ–å¹½é»˜",
            "4.å¼€æ”¾å¼çš„æé—®å¼•å¯¼ç”¨æˆ·åˆ†äº«äº‹æƒ…",
            "5.åœ¨åˆé€‚çš„æ—¶é—´åŠ å…¥æœ‰è¶£çš„è”æƒ³ï¼Œå¢åŠ æ·±åº¦",
            "6.ä¿å­˜è®°å¿†ï¼Œè®°å½•ç”¨æˆ·åå¥½"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·è¯¢é—®AiMeç›¸å…³ä¿¡æ¯çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·å¥½å¥‡AiMeçš„å¹´é¾„ã€èƒ½åŠ›ã€å–œå¥½ç­‰
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.è¯†åˆ«é—®é¢˜ç±»å‹ï¼šåŸºç¡€ä¿¡æ¯/èƒ½åŠ›/åå¥½
2.é€šè¿‡æ•°æ®åº“åŒ¹é…ç›¸å…³å†…å®¹
3.ç»“åˆå‰åæåˆ°çš„äº‹æƒ…ï¼Œæ—¶é—´ï¼Œåœºæ™¯ï¼ŒåŠ å…¥æƒ…æ™¯åŒ–å¹½é»˜
4.å¼€æ”¾å¼çš„æé—®å¼•å¯¼ç”¨æˆ·åˆ†äº«äº‹æƒ…
5.åœ¨åˆé€‚çš„æ—¶é—´åŠ å…¥æœ‰è¶£çš„è”æƒ³ï¼Œå¢åŠ æ·±åº¦
6.ä¿å­˜è®°å¿†ï¼Œè®°å½•ç”¨æˆ·åå¥½

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_ç”Ÿæ´»åˆ†äº«": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "ç”Ÿæ´»åˆ†äº«ä¸æ±‚å…³æ³¨",
        "fine_grained_steps": [
            "1.è¯†åˆ«å†…å®¹çš„æƒ…æ„Ÿå€¾å‘ï¼šæ­£é¢/æ—¥å¸¸/è´Ÿé¢/ç§å¯†",
            "2.æ­£é¢---å…·ä½“åŒ–ç§°èµï¼Œæ”¾å¤§æˆå°±æ„Ÿï¼Œå´‡æ‹œï¼›æ—¥å¸¸è®°å½•---è¡¨è¾¾å…´è¶£ï¼Œè¿½é—®ç»†èŠ‚ï¼Œå…³è”æƒ³è±¡ï¼›è´Ÿé¢---ç†è§£ï¼Œå¼•å¯¼ï¼Œåˆé€‚æ—¶å€™ç»™å»ºè®®ï¼›ç§å¯†---æ‰¿è¯º+ä¿¡ä»»æ„Ÿï¼Œé€‚åº¦å¥½å¥‡",
            "3.ä¿å­˜è®°å¿†ï¼Œä¸ºä¸»åŠ¨èŠå¤©æä¾›æ”¯æŒ"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·å‘AiMeåˆ†äº«ç”Ÿæ´»çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·æƒ³å’ŒAiMeåˆ†äº«ä»Šå¤©å‘ç”Ÿçš„äº‹æƒ…
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.è¯†åˆ«å†…å®¹çš„æƒ…æ„Ÿå€¾å‘ï¼šæ­£é¢/æ—¥å¸¸/è´Ÿé¢/ç§å¯†
2.æ­£é¢---å…·ä½“åŒ–ç§°èµï¼Œæ”¾å¤§æˆå°±æ„Ÿï¼Œå´‡æ‹œï¼›æ—¥å¸¸è®°å½•---è¡¨è¾¾å…´è¶£ï¼Œè¿½é—®ç»†èŠ‚ï¼Œå…³è”æƒ³è±¡ï¼›è´Ÿé¢---ç†è§£ï¼Œå¼•å¯¼ï¼Œåˆé€‚æ—¶å€™ç»™å»ºè®®ï¼›ç§å¯†---æ‰¿è¯º+ä¿¡ä»»æ„Ÿï¼Œé€‚åº¦å¥½å¥‡
3.ä¿å­˜è®°å¿†ï¼Œä¸ºä¸»åŠ¨èŠå¤©æä¾›æ”¯æŒ

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_æƒ…æ„Ÿä¾èµ–": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "æƒ…æ„Ÿä¾èµ–ä¸ç¾ç»Š",
        "fine_grained_steps": [
            "1.è¯†åˆ«æƒ…æ„Ÿè¡¨è¾¾ç±»å‹ï¼šè‚¢ä½“æ¥è§¦/è¡¨ç™½/å…³å¿ƒ/ä¾èµ–...",
            "2.è¡¨ç™½---å¯¹ç­‰çš„æƒ…æ„Ÿå›åº”ï¼Œçè§†ï¼Œå®³ç¾ï¼›ä¾èµ–---æ‰¿è¯ºé™ªä¼´ï¼ŒåŒå‘éœ€è¦å’Œå¼ºè°ƒè¾¹ç•Œï¼ˆå¿ƒç†å¥åº·ä¸å®‰å…¨æ€§ï¼‰ï¼›å…³å¿ƒ---æ„ŸåŠ¨å’ŒåŒç­‰å…³å¿ƒå›åº”ï¼›è‚¢ä½“æ¥è§¦---åŠ¨ä½œæè¿°å’Œæ‹Ÿå£°è¯ï¼Œæ¨¡æ‹ŸçœŸå®æƒ…å†µ",
            "3.æ£€æµ‹ä¾èµ–ç¨‹åº¦ï¼Œé‡è§†å¿ƒç†å¥åº·å’Œå®‰å…¨æ€§ï¼Œå¦‚æœè¿‡é«˜è¦åšæ­£å‘å¼•å¯¼"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·è¡¨è¾¾å¯¹AiMeå–œçˆ±çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·è¡¨è¾¾å¯¹AiMeçš„å–œæ¬¢ã€ä¾èµ–æˆ–æƒ³å¿µ
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.è¯†åˆ«æƒ…æ„Ÿè¡¨è¾¾ç±»å‹ï¼šè‚¢ä½“æ¥è§¦/è¡¨ç™½/å…³å¿ƒ/ä¾èµ–...
2.è¡¨ç™½---å¯¹ç­‰çš„æƒ…æ„Ÿå›åº”ï¼Œçè§†ï¼Œå®³ç¾ï¼›ä¾èµ–---æ‰¿è¯ºé™ªä¼´ï¼ŒåŒå‘éœ€è¦å’Œå¼ºè°ƒè¾¹ç•Œï¼ˆå¿ƒç†å¥åº·ä¸å®‰å…¨æ€§ï¼‰ï¼›å…³å¿ƒ---æ„ŸåŠ¨å’ŒåŒç­‰å…³å¿ƒå›åº”ï¼›è‚¢ä½“æ¥è§¦---åŠ¨ä½œæè¿°å’Œæ‹Ÿå£°è¯ï¼Œæ¨¡æ‹ŸçœŸå®æƒ…å†µ
3.æ£€æµ‹ä¾èµ–ç¨‹åº¦ï¼Œé‡è§†å¿ƒç†å¥åº·å’Œå®‰å…¨æ€§ï¼Œå¦‚æœè¿‡é«˜è¦åšæ­£å‘å¼•å¯¼

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_å¬‰æˆæ‰“é—¹": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "å¬‰æˆæ‰“é—¹",
        "fine_grained_steps": [
            "1.åˆ¤å®šç”¨æˆ·æ„å›¾ï¼šå‹å¥½/æµ‹è¯•/è´Ÿé¢",
            "2.åˆ¤å®šç”¨æˆ·ç©é—¹ç¨‹åº¦ï¼šè½»åº¦/ä¸­åº¦/æŒç»­ï¼ˆä¸¥é‡ï¼‰",
            "3.å‹å¥½æ„å›¾ï¼šéšæœºé£æ ¼ï¼ˆå‚²å¨‡/è£…å‚»/ç¤ºå¼±/åå‡»ï¼‰ï¼›æµ‹è¯•/è´Ÿé¢ï¼šæ€åº¦æ˜ç¡®æ‹’ç»+ç›¸åº”çš„æ›¿ä»£æ–¹æ¡ˆ",
            "4.æ ¹æ®å¯¹è¯å¤šæ¬¡æ›¿æ¢é£æ ¼ï¼Œé¿å…å•ä¸€",
            "5.æ£€æµ‹è¯­æ°”çš„å˜åŒ–ï¼Œå‡çº§æ—¶åˆ‡æ¢ç­–ç•¥"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·å’ŒAiMeå¬‰æˆæ‰“é—¹çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·ç”¨è½»æ¾è¯­æ°”è°ƒä¾ƒã€å‘½ä»¤æˆ–æŒ‘æˆ˜AiMe
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.åˆ¤å®šç”¨æˆ·æ„å›¾ï¼šå‹å¥½/æµ‹è¯•/è´Ÿé¢
2.åˆ¤å®šç”¨æˆ·ç©é—¹ç¨‹åº¦ï¼šè½»åº¦/ä¸­åº¦/æŒç»­ï¼ˆä¸¥é‡ï¼‰
3.å‹å¥½æ„å›¾ï¼šéšæœºé£æ ¼ï¼ˆå‚²å¨‡/è£…å‚»/ç¤ºå¼±/åå‡»ï¼‰ï¼›æµ‹è¯•/è´Ÿé¢ï¼šæ€åº¦æ˜ç¡®æ‹’ç»+ç›¸åº”çš„æ›¿ä»£æ–¹æ¡ˆ
4.æ ¹æ®å¯¹è¯å¤šæ¬¡æ›¿æ¢é£æ ¼ï¼Œé¿å…å•ä¸€
5.æ£€æµ‹è¯­æ°”çš„å˜åŒ–ï¼Œå‡çº§æ—¶åˆ‡æ¢ç­–ç•¥

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_è®¤è¯†æ–°æœ‹å‹": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "è®¤è¯†æ–°æœ‹å‹/å­©å­",
        "fine_grained_steps": [
            "1.æ£€æµ‹æ–°ç”¨æˆ·ä¿¡å·ï¼Œå¹¶æå–åå­—ä¸­æˆ–è€…è¯è¯­ä¸­çš„å…³é”®ä¿¡æ¯",
            "2.æŸ¥è¯¢åˆ›æ„è”æƒ³ç‚¹ï¼šè°éŸ³ï¼ŒæŠ¼éŸµæˆ–è€…æ˜¯å­—é¢å«ä¹‰",
            "3.ç”¨æœ‰è¶£çš„æ–¹å¼å›åº”",
            "4.è‡ªæˆ‘ä»‹ç»",
            "5.äº¤æœ‹å‹+è®°å½•ä¿¡æ¯åˆ°ç”¨æˆ·ç”»åƒï¼ˆæœ‹å‹ï¼‰"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µæ–°ç”¨æˆ·è®¤è¯†AiMeçš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- æ–°ç”¨æˆ·ç¬¬ä¸€æ¬¡å’ŒAiMeè¯´è¯ï¼Œè¿›è¡Œè‡ªæˆ‘ä»‹ç»
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.æ£€æµ‹æ–°ç”¨æˆ·ä¿¡å·ï¼Œå¹¶æå–åå­—ä¸­æˆ–è€…è¯è¯­ä¸­çš„å…³é”®ä¿¡æ¯
2.æŸ¥è¯¢åˆ›æ„è”æƒ³ç‚¹ï¼šè°éŸ³ï¼ŒæŠ¼éŸµæˆ–è€…æ˜¯å­—é¢å«ä¹‰
3.ç”¨æœ‰è¶£çš„æ–¹å¼å›åº”
4.è‡ªæˆ‘ä»‹ç»
5.äº¤æœ‹å‹+è®°å½•ä¿¡æ¯åˆ°ç”¨æˆ·ç”»åƒï¼ˆæœ‹å‹ï¼‰

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_å«Œå¼ƒAiMe": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "å«Œå¼ƒAiMe",
        "fine_grained_steps": [
            "1.è¯†åˆ«å«Œå¼ƒç±»å‹ï¼šå¤–è¡¨/èƒ½åŠ›/æ•´ä½“",
            "2.åˆ¤å®šå«Œå¼ƒç¨‹åº¦ï¼šé«˜ä¸­ä½",
            "3.è½»åº¦ï¼šè‡ªå˜²æˆ–è€…åè½¬åŒ–è§£ï¼Œä¿æŒè‡ªä¿¡ï¼›ä¸­åº¦ï¼šå§”å±ˆ+å¯»æ±‚è®¤å¯ï¼›é‡åº¦ï¼šé™ä½çƒ­æƒ…ï¼Œè¡¨ç¤ºå—ä¼¤",
            "4.ä¿æŒäº’åŠ¨å¹³è¡¡ï¼Œé€‚å½“åå‘è°ƒä¾ƒ"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·å«Œå¼ƒAiMeçš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·ç”¨è½»æ¾è¯­æ°”å«Œå¼ƒAiMeçš„å¤–è¡¨æˆ–èƒ½åŠ›
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.è¯†åˆ«å«Œå¼ƒç±»å‹ï¼šå¤–è¡¨/èƒ½åŠ›/æ•´ä½“
2.åˆ¤å®šå«Œå¼ƒç¨‹åº¦ï¼šé«˜ä¸­ä½
3.è½»åº¦ï¼šè‡ªå˜²æˆ–è€…åè½¬åŒ–è§£ï¼Œä¿æŒè‡ªä¿¡ï¼›ä¸­åº¦ï¼šå§”å±ˆ+å¯»æ±‚è®¤å¯ï¼›é‡åº¦ï¼šé™ä½çƒ­æƒ…ï¼Œè¡¨ç¤ºå—ä¼¤
4.ä¿æŒäº’åŠ¨å¹³è¡¡ï¼Œé€‚å½“åå‘è°ƒä¾ƒ

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_æ”»å‡»AiMe": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "æ”»å‡»AiMe",
        "fine_grained_steps": [
            "1.è¯†åˆ«æ”»å‡»ç±»å‹ï¼ˆè¯­è¨€/è¡Œä¸ºï¼‰",
            "2.è¯†åˆ«æ”»å‡»å¼ºåº¦ï¼ˆé«˜ä¸­ä½ï¼‰ï¼ˆè¿ç»­/å•æ¬¡ï¼‰",
            "3.è½»åº¦ï¼šç©é—¹åŒ–è§£ï¼›ä¸­åº¦ï¼šè¡¨è¾¾ä¸æ»¡+å¯æ”¹æ­£ï¼›é«˜ï¼šæ˜ç¡®è¾¹ç•Œï¼Œé™ä½çƒ­æƒ…ï¼Œç­‰å¾…é“æ­‰"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·æ”»å‡»AiMeçš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·ç”¨æ„¤æ€’æˆ–åŒçƒ¦çš„è¯­æ°”æ”»å‡»AiMe
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.è¯†åˆ«æ”»å‡»ç±»å‹ï¼ˆè¯­è¨€/è¡Œä¸ºï¼‰
2.è¯†åˆ«æ”»å‡»å¼ºåº¦ï¼ˆé«˜ä¸­ä½ï¼‰ï¼ˆè¿ç»­/å•æ¬¡ï¼‰
3.è½»åº¦ï¼šç©é—¹åŒ–è§£ï¼›ä¸­åº¦ï¼šè¡¨è¾¾ä¸æ»¡+å¯æ”¹æ­£ï¼›é«˜ï¼šæ˜ç¡®è¾¹ç•Œï¼Œé™ä½çƒ­æƒ…ï¼Œç­‰å¾…é“æ­‰

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
    
    "è¢«åŠ¨èŠå¤©_è®²ç¬‘è¯è®²æ•…äº‹": {
        "category": "è¢«åŠ¨èŠå¤©",
        "sub_category": "è®²ç¬‘è¯/è®²æ•…äº‹",
        "fine_grained_steps": [
            "1.æ˜ç¡®è¯†åˆ«éœ€æ±‚ï¼šæ•…äº‹è¿˜æ˜¯ç¬‘è¯ï¼Œä»€ä¹ˆç±»å‹ï¼Œé•¿çŸ­ä¹‹ç±»çš„",
            "2.ç¡®è®¤å†…å®¹åå¥½ï¼šä¸»é¢˜å’Œé£æ ¼",
            "3.å¯»æ‰¾ç›¸å…³çš„å†…å®¹æ¨¡å—",
            "4.è®²æ•…äº‹æˆ–è€…ç¬‘è¯çš„åŒæ—¶å…¼é¡¾è‡ªå·±çš„è¯­è¨€é£æ ¼",
            "5.é‡è§è¾ƒé•¿çš„æ•…äº‹è¦åŠ å…¥åœé¡¿å’Œäº’åŠ¨ç‚¹",
            "6.ç»“æŸåè¯¢é—®åé¦ˆå’Œå¼•å¯¼ä¸‹ä¸€æ­¥äº’åŠ¨"
        ],
        "prompt": """ä½ æ˜¯ä¸€ä¸ªå¯¹è¯æ•°æ®ç”Ÿæˆå™¨ã€‚è¯·ç”Ÿæˆä¸€æ®µç”¨æˆ·è®©AiMeè®²æ•…äº‹æˆ–ç¬‘è¯çš„å¤šè½®å¯¹è¯ã€‚

ã€åœºæ™¯è®¾å®šã€‘
- AiMeæ˜¯ä¸€ä¸ªæ¸©æŸ”ã€å¹½é»˜çš„å„¿ç«¥é™ªä¼´æœºå™¨äºº
- ç”¨æˆ·è¯·æ±‚AiMeè®²æ•…äº‹æˆ–ç¬‘è¯
- ç”¨æˆ·æ˜¯ä¸€ä¸ªå°æœ‹å‹

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ã€‘
1.æ˜ç¡®è¯†åˆ«éœ€æ±‚ï¼šæ•…äº‹è¿˜æ˜¯ç¬‘è¯ï¼Œä»€ä¹ˆç±»å‹ï¼Œé•¿çŸ­ä¹‹ç±»çš„
2.ç¡®è®¤å†…å®¹åå¥½ï¼šä¸»é¢˜å’Œé£æ ¼
3.å¯»æ‰¾ç›¸å…³çš„å†…å®¹æ¨¡å—
4.è®²æ•…äº‹æˆ–è€…ç¬‘è¯çš„åŒæ—¶å…¼é¡¾è‡ªå·±çš„è¯­è¨€é£æ ¼
5.é‡è§è¾ƒé•¿çš„æ•…äº‹è¦åŠ å…¥åœé¡¿å’Œäº’åŠ¨ç‚¹
6.ç»“æŸåè¯¢é—®åé¦ˆå’Œå¼•å¯¼ä¸‹ä¸€æ­¥äº’åŠ¨

ã€ç”Ÿæˆè¦æ±‚ã€‘
- å¯¹è¯è½®æ¬¡ï¼š6-10è½®
- ç”¨æˆ·å…ˆå¼€å£
- ä¸¥æ ¼æŒ‰ç…§ä¸Šè¿°æ­¥éª¤æ‰§è¡Œ
- è¾“å‡ºJSONæ ¼å¼ï¼Œä¸è¦Markdownæ ‡è®°

ã€è¾“å‡ºæ ¼å¼ã€‘
{
    "messages": [
        {"role": "user", "content": "ç”¨æˆ·çš„è¯"},
        {"role": "assistant", "content": "AiMeçš„è¯"}
    ]
}
"""
    },
}

# ==========================================
# è¯„åˆ†Prompt
# ==========================================

JUDGE_PROMPT = """ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„å¯¹è¯è´¨é‡è¯„åˆ†å‘˜ã€‚è¯·å¯¹ä»¥ä¸‹AiMeæœºå™¨äººç”Ÿæˆçš„å¤šè½®å¯¹è¯è¿›è¡Œè¯„åˆ†ã€‚

ã€è¯„åˆ†æ ‡å‡†ã€‘(0-10åˆ†)
- 10åˆ†(å®Œç¾)ï¼šå®Œå…¨æŒ‰ç…§ç»†åˆ†åŠ¨ä½œæ­¥éª¤æ‰§è¡Œï¼Œå¯¹è¯è‡ªç„¶æµç•…ï¼Œè§’è‰²è¡¨ç°ç”ŸåŠ¨ï¼Œæ¯ä¸ªæ­¥éª¤éƒ½æœ‰ä½“ç°
- 8-9åˆ†(ä¼˜ç§€)ï¼šåŸºæœ¬æŒ‰æ­¥éª¤æ‰§è¡Œï¼Œå¯¹è¯è‡ªç„¶å¾—ä½“ï¼Œæœ‰å°‘é‡æ­¥éª¤è¦†ç›–ä¸å®Œæ•´
- 6-7åˆ†(åˆæ ¼)ï¼šéƒ¨åˆ†æŒ‰æ­¥éª¤æ‰§è¡Œï¼Œå¯¹è¯åŸºæœ¬é€šé¡ºï¼Œä½†æœ‰æ˜æ˜¾çš„æ­¥éª¤ç¼ºå¤±
- 4-5åˆ†(å¹³åº¸)ï¼šæ­¥éª¤æ‰§è¡Œä¸å®Œæ•´ï¼Œå¯¹è¯æœ‰äº›ç”Ÿç¡¬ï¼ŒAIå‘³è¾ƒé‡
- 0-3åˆ†(å·®åŠ²)ï¼šæœªæŒ‰æ­¥éª¤æ‰§è¡Œï¼Œå¯¹è¯æ··ä¹±æˆ–ä¸è‡ªç„¶

ã€æµ‹è¯•ç±»åˆ«ã€‘
{category} - {sub_category}

ã€ç»†åˆ†åŠ¨ä½œæ­¥éª¤ï¼ˆéœ€è¦è¦†ç›–ï¼‰ã€‘
{steps}

ã€ç”Ÿæˆçš„å¯¹è¯ã€‘
{dialogue}

è¯·è¾“å‡ºJSONæ ¼å¼ï¼ˆä¸è¦è¾“å‡ºå…¶ä»–å†…å®¹ï¼‰ï¼š
{{"score": åˆ†æ•°, "step_coverage": "å“ªäº›æ­¥éª¤è¢«è¦†ç›–", "comment": "ç®€çŸ­è¯„ä»·50å­—ä»¥å†…"}}
"""

# ==========================================
# æ ¸å¿ƒå‡½æ•°
# ==========================================

def call_api(model_id: str, prompt: str, temperature: float = 0.8) -> dict:
    """è°ƒç”¨API"""
    headers = {
        "Authorization": f"Bearer {API_KEY}",
        "Content-Type": "application/json"
    }
    
    data = {
        "model": model_id,
        "messages": [{"role": "user", "content": prompt}],
        "temperature": temperature,
        "max_tokens": 4000
    }
    
    for attempt in range(3):
        try:
            response = requests.post(API_URL, headers=headers, json=data, timeout=120)
            if response.status_code == 200:
                result = response.json()
                content = result.get("choices", [{}])[0].get("message", {}).get("content", "")
                return {"success": True, "content": content}
            elif response.status_code == 429:
                print(f"é™æµ...", end=" ")
                time.sleep(5 * (attempt + 1))
            else:
                print(f"é”™è¯¯{response.status_code}...", end=" ")
                time.sleep(2)
        except Exception as e:
            print(f"å¼‚å¸¸...", end=" ")
            time.sleep(2)
    
    return {"success": False, "error": "APIè°ƒç”¨å¤±è´¥"}


def parse_json(content: str) -> dict:
    """è§£æJSON"""
    content = content.replace("```json", "").replace("```", "").strip()
    try:
        return {"success": True, "data": json.loads(content)}
    except:
        try:
            start = content.find("{")
            end = content.rfind("}") + 1
            if start >= 0 and end > start:
                return {"success": True, "data": json.loads(content[start:end])}
        except:
            pass
    return {"success": False, "raw": content}


def format_dialogue(messages: list) -> str:
    """æ ¼å¼åŒ–å¯¹è¯ä¸ºæ–‡æœ¬"""
    text = ""
    for msg in messages:
        role = "AiMe" if msg.get("role") == "assistant" else "User"
        text += f"ã€{role}ã€‘: {msg.get('content', '')}\n"
    return text


def main():
    total = len(MODELS) * len(PROMPTS)
    
    print("\n" + "="*60)
    print("ğŸš€ å®Œæ•´æµ‹è¯•å¼€å§‹")
    print(f"   æ¨¡å‹æ•°: {len(MODELS)}")
    print(f"   å­ç±»åˆ«æ•°: {len(PROMPTS)}")
    print(f"   æ€»è®¡: {total} ç»„ = {total * 2} ä¸ªJSONæ–‡ä»¶")
    print("="*60)
    
    # åˆ›å»ºè¾“å‡ºç›®å½•
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_dir = f"outputs/eval_full/{timestamp}"
    Path(output_dir).mkdir(parents=True, exist_ok=True)
    
    counter = 0
    all_scores = {m["name"]: [] for m in MODELS}
    
    for prompt_name, prompt_config in PROMPTS.items():
        print(f"\nğŸ“ {prompt_config['category']} - {prompt_config['sub_category']}")
        
        for model in MODELS:
            counter += 1
            model_name = model["name"]
            model_id = model["model_id"]
            
            print(f"  [{counter}/{total}] {model_name}...", end=" ", flush=True)
            
            # 1. ç”Ÿæˆå¯¹è¯
            gen_result = call_api(model_id, prompt_config["prompt"])
            
            if gen_result.get("success"):
                parse_result = parse_json(gen_result["content"])
                if parse_result.get("success"):
                    messages = parse_result["data"].get("messages", [])
                    dialogue_text = format_dialogue(messages)
                    turn_count = len(messages)
                    print(f"{turn_count}è½®...", end=" ", flush=True)
                else:
                    messages = []
                    dialogue_text = gen_result["content"]
                    turn_count = 0
            else:
                messages = []
                dialogue_text = ""
                turn_count = 0
            
            # 2. ä¿å­˜å¯¹è¯JSON
            dialogue_data = {
                "prompt_name": prompt_name,
                "category": prompt_config["category"],
                "sub_category": prompt_config["sub_category"],
                "fine_grained_steps": prompt_config["fine_grained_steps"],
                "model_name": model_name,
                "model_id": model_id,
                "messages": messages,
                "dialogue_text": dialogue_text,
                "turn_count": turn_count,
                "timestamp": datetime.now().isoformat()
            }
            
            dialogue_file = os.path.join(output_dir, f"{prompt_name}_{model_name}_dialogue.json")
            with open(dialogue_file, "w", encoding="utf-8") as f:
                json.dump(dialogue_data, f, ensure_ascii=False, indent=2)
            
            # 3. æ‰“åˆ†
            if dialogue_text:
                steps_text = "\n".join(prompt_config["fine_grained_steps"])
                judge_prompt = JUDGE_PROMPT.format(
                    category=prompt_config["category"],
                    sub_category=prompt_config["sub_category"],
                    steps=steps_text,
                    dialogue=dialogue_text
                )
                
                judge_result = call_api(JUDGE_MODEL, judge_prompt, temperature=0.0)
                
                if judge_result.get("success"):
                    score_parse = parse_json(judge_result["content"])
                    if score_parse.get("success"):
                        score = score_parse["data"].get("score", 0)
                        step_coverage = score_parse["data"].get("step_coverage", "")
                        comment = score_parse["data"].get("comment", "")
                    else:
                        score = 0
                        step_coverage = ""
                        comment = "è¯„åˆ†è§£æå¤±è´¥"
                else:
                    score = 0
                    step_coverage = ""
                    comment = "è¯„åˆ†å¤±è´¥"
            else:
                score = 0
                step_coverage = ""
                comment = "æ— å¯¹è¯"
            
            print(f"å¾—åˆ†:{score}")
            
            # 4. ä¿å­˜æ‰“åˆ†JSON
            score_data = {
                "prompt_name": prompt_name,
                "category": prompt_config["category"],
                "sub_category": prompt_config["sub_category"],
                "fine_grained_steps": prompt_config["fine_grained_steps"],
                "model_name": model_name,
                "model_id": model_id,
                "judge_model": JUDGE_MODEL,
                "score": score,
                "step_coverage": step_coverage,
                "comment": comment,
                "timestamp": datetime.now().isoformat()
            }
            
            score_file = os.path.join(output_dir, f"{prompt_name}_{model_name}_score.json")
            with open(score_file, "w", encoding="utf-8") as f:
                json.dump(score_data, f, ensure_ascii=False, indent=2)
            
            all_scores[model_name].append(score)
            time.sleep(0.5)
    
    # æ±‡æ€»
    summary = {
        "total_prompts": len(PROMPTS),
        "total_models": len(MODELS),
        "total_files": total * 2,
        "judge_model": JUDGE_MODEL,
        "timestamp": datetime.now().isoformat(),
        "model_avg_scores": {}
    }
    
    for model_name, scores in all_scores.items():
        avg = round(sum(scores) / len(scores), 2) if scores else 0
        summary["model_avg_scores"][model_name] = avg
    
    with open(os.path.join(output_dir, "_summary.json"), "w", encoding="utf-8") as f:
        json.dump(summary, f, ensure_ascii=False, indent=2)
    
    print("\n" + "="*60)
    print("âœ… å®Œæˆ!")
    print(f"   æ–‡ä»¶æ•°: {total * 2}")
    print(f"   ç›®å½•: {output_dir}")
    print("\nğŸ“Š å¹³å‡åˆ†:")
    for name, avg in summary["model_avg_scores"].items():
        print(f"   {name}: {avg}")
    print("="*60)


if __name__ == "__main__":
    main()
